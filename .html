<style>
    /* ==========================================================================
   4. Print Styles (Modernized & Optimized V2) - Replaces previous print block
   ========================================================================== */
@media print {
    /* --- Basic Setup --- */
    @page {
        size: A4;
        margin: 1.5cm; /* Standard A4 margins */
    }
    html, body {
        width: 100% !important;
        height: auto !important; /* Allow content height */
        margin: 0 !important;
        padding: 0 !important;
        font-size: 9pt !important; /* Base print font size */
        line-height: 1.35 !important; /* Slightly adjusted line height */
        background-color: #ffffff !important;
        color: #000000 !important;
        font-family: sans-serif; /* Default sans-serif for body */
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }

    /* --- Hide Unwanted Elements --- */
    .no-print, .invoice-actions, .sidebar-nav, .admin-header, .admin-footer,
    #copy-upi-btn, /* Hide copy button */
    .pay-option p:not(:first-child), /* Hide secondary payment text */
    .pay-option a#payment-link, /* Hide click-to-pay link */
    .pay-option input#upi-id-input /* Hide UPI input field */
     { display: none !important; }

    /* --- Main Container Reset --- */
    .page-container, .main-content { padding: 0 !important; margin: 0 !important; }
    .invoice-container { width: 100% !important; max-width: 100% !important; margin: 0 !important; padding: 0 !important; box-shadow: none !important; border: none !important; border-radius: 0 !important; background: none !important; }

    /* --- Layout & Spacing Adjustments --- */
    .invoice-header, .invoice-meta, .invoice-section, .invoice-footer {
        margin-bottom: 0.7cm !important; /* Reduced vertical spacing */
        padding-bottom: 0 !important; border: none !important;
        page-break-inside: avoid !important;
    }

    /* 1. Header Font & Layout */
    .invoice-header {
        padding-bottom: 0.5cm !important;
        border-bottom: 1px solid #333333 !important; /* Clearer border */
        display: flex !important; flex-direction: row !important; align-items: flex-start !important; justify-content: space-between !important;
    }
     .header-logo img { width: 55px !important; margin-right: 1cm;} /* Fixed logo size */
     .header-title { text-align: center !important; flex-grow: 1; }
     .header-title h1 {
        font-family: 'Times New Roman', Times, serif !important; /* <<< FONT CHANGE */
        font-size: 16pt !important; font-weight: bold !important; margin: 0 0 2px 0 !important; color: #000 !important;
     }
     .header-title p {
        font-family: 'Times New Roman', Times, serif !important; /* <<< FONT CHANGE */
        font-size: 8pt !important; margin: 0 !important; font-style: italic; color: #333 !important;
     }
     .header-contact { text-align: right !important; font-size: 7pt !important; line-height: 1.3 !important; color: #333 !important; flex-shrink: 0; min-width: 150px; /* Prevent wrapping */}
     .header-contact p { margin: 0 !important; }
     .header-contact i { display: none !important; } /* Hide icons in print */

    /* 2. Bill To / Invoice Meta Layout */
    .invoice-meta {
        margin-top: 0.8cm !important;
        display: flex !important; justify-content: space-between !important; align-items: flex-start !important;
    }
    .bill-to, .invoice-details { width: 48%; font-size: 8pt !important; }
    .bill-to h3, .invoice-details h2 { font-size: 8pt !important; margin-bottom: 4px !important; color: #333 !important; font-weight: bold; text-transform: uppercase;}
    .invoice-details h2 { font-size: 11pt !important; text-align: right !important; margin-bottom: 6px !important;}
    .bill-to p { font-size: 9pt !important; margin: 1px 0 !important; font-weight: bold;}
    .invoice-details p { font-size: 8pt !important; margin: 2px 0 !important; text-align: right !important;}
    .invoice-details strong { font-weight: bold; color: #000;}

    /* 3. Trip Summary Centering & Line Break Fix */
    .invoice-section h3 { font-size: 10pt !important; font-weight: bold !important; color: #000 !important; margin: 0 0 0.4cm 0 !important; padding-bottom: 2px !important; border-bottom: 1px solid #ccc !important;}
    .summary-table {
        width: 80% !important; /* <<< Reduced width */
        margin: 0 auto !important; /* <<< Centering */
        font-size: 8pt !important;
    }
    .summary-table td { border-bottom: 1px dotted #ccc !important; padding: 3px 0 !important;} /* Dotted line */
    .summary-table tr:last-child td { border-bottom: none !important;}
    .summary-table td:first-child { width: 90px !important; font-weight: bold !important; color: #000 !important; white-space: nowrap !important; /* <<< Prevents wrapping */}
    .summary-table td:last-child { font-weight: normal; color: #000 !important;}


    /* --- Table Styling (Charges) --- */
    .charges-table { margin-top: 0.5cm !important; }
    th, td { padding: 3px 5px !important; font-size: 8pt !important; text-align: left !important; vertical-align: top !important; line-height: 1.3 !important;}
    .charges-table th { font-weight: bold !important; background-color: #eeeeee !important; color: #000 !important; border-bottom: 1px solid #666 !important; }
    .charges-table td { border-bottom: 1px solid #e0e0e0 !important; }
    .charges-table tbody tr:last-child td { border-bottom: none !important; }
    .charges-table th:nth-child(3), .charges-table td:nth-child(3),
    .charges-table th:nth-child(4), .charges-table td:nth-child(4) { text-align: right !important; }
    .charges-table td:nth-child(2) { color: #444 !important; font-style: italic; } /* Muted details */

    .charges-table tfoot .total-row td { font-size: 10pt !important; font-weight: bold !important; padding-top: 5px !important; border-top: 1.5px solid #000 !important; }
    .charges-table tfoot .total-amount { color: #000 !important; }

    .amount-in-words { font-size: 8pt !important; font-weight: bold !important; margin-top: 4px !important; text-align: right !important; color: #000 !important; }

    /* --- Footer Sections (Payment/Terms Side-by-Side, Compact) --- */
    .invoice-footer {
        margin-top: 0.8cm !important; padding-top: 0.5cm !important;
        border-top: 1px solid #999 !important;
        display: flex !important; justify-content: space-between !important; align-items: flex-start !important;
    }
    .payment-section, .terms-section { width: 48% !important; }

    .payment-section h3, .terms-section h3 { font-size: 9pt !important; margin-bottom: 0.3cm !important; color: #000 !important;}
    .payment-section > p { display: none !important; } /* Hide "Choose method..." */

    .payment-options { display: block !important; }
    .pay-option { background: none !important; border: none !important; padding: 0 !important; margin-bottom: 0.5cm !important; text-align: left !important;}
    .pay-option h4 { font-size: 8pt !important; margin-bottom: 3px !important; font-weight: bold; color: #000 !important;}

    /* 4. QR Code Size */
    .qr-code, #qr-code-canvas {
        max-width: 1.5cm !important; /* <<< Increased size */
        height: 1.5cm !important;  /* <<< Increased size */
        margin: 0 0 5px 0 !important;
        border: 1px solid #bbbbbb !important; /* Thin border */
        padding: 1px !important; /* Small padding inside border */
        box-sizing: border-box !important;
        overflow: visible !important; /* Ensure it's not clipped */
    }
    #qr-code-canvas svg { width: 100% !important; height: 100% !important; }

    /* Show UPI ID as text */
     .pay-option:nth-child(3) h4::after {
        content: ': ' attr(data-upi-id); /* <<< Displays the UPI ID */
        font-weight: normal;
        color: #000;
        font-size: 8pt;
     }

    .terms-section ol { font-size: 7pt !important; line-height: 1.3 !important; padding-left: 12px !important; margin: 0 !important; color: #333 !important; }
    .terms-section li { margin-bottom: 2px !important; }
    .terms-section a { color: #000 !important; text-decoration: none !important; font-weight: normal !important; }

    /* --- Final Footer --- */
    .invoice-print-footer {
        display: block !important; text-align: center !important; font-size: 7pt !important; color: #888 !important;
        margin-top: 1cm !important; padding-top: 0.3cm !important; border-top: 1px solid #ccc !important;
        width: 100% !important;
        /* Avoid position:fixed for print unless absolutely necessary and tested */
    }

    /* --- Page Break Control --- */
    h1, h2, h3, h4, h5, h6, p, blockquote, ul, ol, li, table, thead, tfoot, tr, img {
        page-break-inside: avoid !important; /* Try to keep elements together */
    }
    thead { display: table-header-group !important; } /* Repeat table head */
}

</style>

<body>
    <div class="invoice-container">
        <header class="invoice-header">
            <div class="header-logo">
                <img src="/assets/images/logo.webp" alt="Shrish Group Logo">
            </div>
            <div class="header-title">
                <h1>ShRiSH Travels</h1>
                <p>Your Journey, Our Responsibility</p>
            </div>
            <div class="header-contact">
                <p><i class="fas fa-phone-alt"></i> +91 88834 51668</p>
                <p><i class="fas fa-phone-alt"></i> +91 91765 00207</p>
                <p><i class="fas fa-envelope"></i> info@shrishgroup.com</p>
                <p><i class="fas fa-globe"></i> www.shrishgroup.com</p>
            </div>
        </header>

        <section class="invoice-meta">
            <div class="bill-to">
                <h3>Bill To:</h3>
                <p id="guest-name">Loading...</p>
                <p id="guest-mobile">Loading...</p>
            </div>
            <div class="invoice-details">
                <h2>INVOICE</h2>
                <p><strong>Invoice #:</strong> <span id="invoice-id">Loading...</span></p>
                <p><strong>Invoice Date:</strong> <span id="invoice-date">Loading...</span></p>
                <p><strong>Due Date:</strong> Due Upon Receipt</p>
            </div>
        </section>

        <section class="invoice-section">
            <h3>Trip Summary</h3>
            <table class="summary-table">
                <tr>
                    <td><strong>Vehicle:</strong></td>
                    <td id="trip-vehicle">Loading...</td>
                </tr>
                <tr>
                    <td><strong>Trip Dates:</strong></td>
                    <td id="trip-dates">Loading...</td>
                </tr>
                <tr>
                    <td><strong>Total KMs:</strong></td>
                    <td id="trip-total-kms">Loading...</td>
                </tr>
                <tr>
                    <td><strong>Total Duration:</strong></td>
                    <td id="trip-total-duration">Loading...</td>
                </tr>
            </table>
        </section>

        <section class="invoice-section">
            <h3>Itemized Charges</h3>
            <table class="charges-table">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th>Details</th>
                        <th>Rate (₹)</th>
                        <th>Amount (₹)</th>
                    </tr>
                </thead>
                <tbody id="charges-tbody">
                    <tr>
                        <td colspan="4" style="text-align: center;">Loading charges...</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="3" class="total-label">Grand Total</td>
                        <td class="total-amount" id="grand-total">₹ --.--</td>
                    </tr>
                </tfoot>
            </table>
            <p class="amount-in-words" id="amount-in-words">Loading...</p>
        </section>

        <section class="invoice-footer">
            <div class="payment-section">
                <h3>Pay Your Bill</h3>
                <p>Choose your preferred method to pay <strong><span id="total-due-amount">₹ --.--</span></strong></p>
                <div class="payment-options">
                    <div class="pay-option">
                        <h4>1. Scan to Pay</h4>
                        <div id="qr-code-canvas" class="qr-code"></div>
                        <p>Scan with any UPI app</p>
                    </div>
                    <div class="pay-option">
                        <h4>2. Pay with UPI App</h4>
                        <a href="#" class="btn btn-success" id="payment-link">
                            Pay ₹<span id="total-due-amount-button">--.--</span> with UPI
                        </a>
                        <p>(For mobile users)</p>
                    </div>
                    <div class="pay-option">
                        <h4>3. Copy UPI ID</h4>
                        <input type="text" value="payments@shrish" id="upi-id-input" readonly>
                        <button class="btn" id="copy-upi-btn">Copy UPI ID</button>
                    </div>
                </div>
            </div>

            <div class="terms-section">
                <h3>Terms & Conditions</h3>
                <ol>
                    <li>All charges (Kilometers & Time) are calculated on a "shed-to-shed" basis.</li>
                    <li>Billing is based on 12-hour slabs. Any usage into the next slab will be billed as a full slab.
                    </li>
                    <li>Toll, parking, and state permit charges are as per actuals.</li>
                    <li>Full payment is due upon receipt of this invoice.</li>
                    <li>Thank you for your business!</li>
                    <li>
                        Enjoyed our service?
                        <a href="https://g.page/r/CaYoGVSEfXMNEBM/review" target="_blank" rel="noopener">
                            Please leave us a review on Google!
                        </a>
                    </li>
                </ol>
            </div>
        </section>

        <footer class="invoice-print-footer">
            <p>This is a system-generated invoice. | Shrish Travels | www.shrishgroup.com</p>
        </footer>
    </div>
    
    <div class="invoice-actions no-print">
        <button class="btn btn-primary" onclick="window.print()">
            <i class="fas fa-print"></i> Print / Save as PDF
        </button>
        <button class="btn" onclick="window.close()">
            <i class="fas fa-times"></i> Close
        </button>
    </div>

    <!-- <script src="/assets/js/view-invoice.js"></script> -->
</body>